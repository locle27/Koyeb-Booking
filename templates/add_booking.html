{% extends "base.html" %}
{% block title %}Th√™m ƒê·∫∑t ph√≤ng M·ªõi{% endblock %}

{% block content %}
<h1 class="mb-4">Th√™m ƒê·∫∑t ph√≤ng M·ªõi</h1>

<!-- Duplicate Warning Modal -->
{% if duplicate_warning %}
<div class="alert alert-warning border-0 shadow-lg mb-4" style="background: linear-gradient(135deg, #ff9500 0%, #ff6b35 100%); color: white;">
    <h4 class="alert-heading">
        <i class="fas fa-exclamation-triangle me-2"></i>‚ö†Ô∏è Ph√°t hi·ªán kh√°ch c√≥ th·ªÉ tr√πng l·∫∑p!
    </h4>
    
    {% for duplicate in duplicate_warning.duplicates %}
    <div class="row mt-3">
        <div class="col-md-6">
            <div class="card bg-white bg-opacity-20 border-0">
                <div class="card-body">
                    <h6 class="text-white">üìù Booking M·ªöI (ƒëang th√™m)</h6>
                    <div class="text-white-75">
                        <strong>T√™n:</strong> {{ duplicate.new_booking.guest_name }}<br>
                        <strong>Check-in:</strong> {{ duplicate.new_booking.check_in_date }}<br>
                        <strong>Check-out:</strong> {{ duplicate.new_booking.check_out_date }}<br>
                        <strong>Ph√≤ng:</strong> {{ duplicate.new_booking.room_type }}
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card bg-white bg-opacity-20 border-0">
                <div class="card-body">
                    <h6 class="text-white">üóÉÔ∏è Booking HI·ªÜN T·∫†I (trong h·ªá th·ªëng)</h6>
                    <div class="text-white-75">
                        <strong>ID:</strong> {{ duplicate.existing_booking.booking_id }}<br>
                        <strong>T√™n:</strong> {{ duplicate.existing_booking.guest_name }}<br>
                        <strong>Check-in:</strong> {{ duplicate.existing_booking.check_in_date }}<br>
                        <strong>Check-out:</strong> {{ duplicate.existing_booking.check_out_date }}<br>
                        <strong>Tr·∫°ng th√°i:</strong> {{ duplicate.existing_booking.status }}
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
    
    <div class="mt-3">
        <h6>üí° L·ª±a ch·ªçn c·ªßa b·∫°n:</h6>
        <div class="d-flex gap-3">
            <form method="POST" action="{{ url_for('add_booking') }}" style="display: inline;">
                {% for key, value in form_data.items() %}
                <input type="hidden" name="{{ key }}" value="{{ value }}">
                {% endfor %}
                <input type="hidden" name="force_add" value="1">
                <button type="submit" class="btn btn-success">
                    <i class="fas fa-plus me-1"></i>‚úÖ V·∫´n th√™m booking m·ªõi
                </button>
            </form>
            <button type="button" class="btn btn-secondary" onclick="clearForm()">
                <i class="fas fa-times me-1"></i>‚ùå H·ªßy v√† ki·ªÉm tra l·∫°i
            </button>
        </div>
    </div>
</div>
{% endif %}

<form method="POST" action="{{ url_for('add_booking') }}">
    <div class="row g-3">
        <div class="col-md-6">
            <label for="T√™n ng∆∞·ªùi ƒë·∫∑t" class="form-label">T√™n ng∆∞·ªùi ƒë·∫∑t</label>
            <input type="text" class="form-control" id="T√™n ng∆∞·ªùi ƒë·∫∑t" name="T√™n ng∆∞·ªùi ƒë·∫∑t" 
                   value="{{ form_data.get('T√™n ng∆∞·ªùi ƒë·∫∑t', '') if form_data else '' }}" required>
        </div>
        <div class="col-md-6">
            <label for="S·ªë ƒë·∫∑t ph√≤ng" class="form-label">S·ªë ƒë·∫∑t ph√≤ng (Booking ID)</label>
            <input type="text" class="form-control" id="S·ªë ƒë·∫∑t ph√≤ng" name="S·ªë ƒë·∫∑t ph√≤ng" 
                   value="{{ form_data.get('S·ªë ƒë·∫∑t ph√≤ng', '') if form_data else '' }}" required>
        </div>

        <div class="col-md-12">
            <label for="T√™n ch·ªó ngh·ªâ" class="form-label">T√™n ch·ªó ngh·ªâ (Room Name)</label>
            <input type="text" class="form-control" id="T√™n ch·ªó ngh·ªâ" name="T√™n ch·ªó ngh·ªâ" 
                   value="{{ form_data.get('T√™n ch·ªó ngh·ªâ', '') if form_data else '' }}" required>
        </div>

        <div class="col-md-4">
            <label for="Ng√†y ƒë·∫øn" class="form-label">Ng√†y ƒë·∫øn (Check-in)</label>
            <input type="date" class="form-control" id="Ng√†y ƒë·∫øn" name="Ng√†y ƒë·∫øn" 
                   value="{{ form_data.get('Ng√†y ƒë·∫øn', '') if form_data else '' }}" required>
        </div>
        <div class="col-md-4">
            <label for="Ng√†y ƒëi" class="form-label">Ng√†y ƒëi (Check-out)</label>
            <input type="date" class="form-control" id="Ng√†y ƒëi" name="Ng√†y ƒëi" 
                   value="{{ form_data.get('Ng√†y ƒëi', '') if form_data else '' }}" required>
        </div>
        <div class="col-md-4">
            <label for="ƒê∆∞·ª£c ƒë·∫∑t v√†o" class="form-label">Ng√†y ƒë·∫∑t (Booking Date)</label>
            <input type="date" class="form-control" id="ƒê∆∞·ª£c ƒë·∫∑t v√†o" name="ƒê∆∞·ª£c ƒë·∫∑t v√†o" 
                   value="{{ form_data.get('ƒê∆∞·ª£c ƒë·∫∑t v√†o', '') if form_data else '' }}" required>
        </div>

        <div class="col-md-6">
            <label for="T·ªïng thanh to√°n" class="form-label">T·ªïng thanh to√°n</label>
            <input type="number" step="0.01" class="form-control" id="T·ªïng thanh to√°n" name="T·ªïng thanh to√°n" required>
        </div>
        <div class="col-md-6">
            <label for="Hoa h·ªìng" class="form-label">Hoa h·ªìng</label>
            <input type="number" step="0.01" class="form-control" id="Hoa h·ªìng" name="Hoa h·ªìng" required>
        </div>
        
        <div class="col-md-4">
            <label for="T√¨nh tr·∫°ng" class="form-label">T√¨nh tr·∫°ng</label>
            <select class="form-select" id="T√¨nh tr·∫°ng" name="T√¨nh tr·∫°ng">
                <option value="OK" selected>OK</option>
                <option value="ƒê√£ h·ªßy">ƒê√£ h·ªßy</option>
            </select>
        </div>
        <div class="col-md-4">
            <label for="Ng∆∞·ªùi thu ti·ªÅn" class="form-label">Ng∆∞·ªùi thu ti·ªÅn</label>
            <input type="text" class="form-control" id="Ng∆∞·ªùi thu ti·ªÅn" name="Ng∆∞·ªùi thu ti·ªÅn">
        </div>
        <div class="col-md-4">
            <label for="Ti·ªÅn t·ªá" class="form-label">Ti·ªÅn t·ªá</label>
            <input type="text" class="form-control" id="Ti·ªÅn t·ªá" name="Ti·ªÅn t·ªá" value="VND">
        </div>

        <div class="col-md-6">
            <label for="V·ªã tr√≠" class="form-label">V·ªã tr√≠</label>
            <input type="text" class="form-control" id="V·ªã tr√≠" name="V·ªã tr√≠">
        </div>
        
        <div class="col-md-6">
            <label for="Th√†nh vi√™n Genius" class="form-label">Th√†nh vi√™n Genius</label>
             <select class="form-select" id="Th√†nh vi√™n Genius" name="Th√†nh vi√™n Genius">
                <option value="Kh√¥ng" selected>Kh√¥ng</option>
                <option value="C√≥">C√≥</option>
            </select>
        </div>

    </div>

    <button type="submit" class="btn btn-primary mt-4">Th√™m ƒê·∫∑t ph√≤ng</button>
    <a href="{{ url_for('view_bookings') }}" class="btn btn-secondary mt-4">H·ªßy</a>
</form>

<script>
function clearForm() {
    // Clear all form fields
    document.querySelectorAll('input, select').forEach(function(element) {
        if (element.type === 'text' || element.type === 'number' || element.type === 'date') {
            element.value = '';
        } else if (element.tagName === 'SELECT') {
            element.selectedIndex = 0;
        }
    });
    
    // Hide any duplicate warning
    const warning = document.querySelector('.alert-warning');
    if (warning) {
        warning.style.display = 'none';
    }
    
    // Focus on first input
    document.querySelector('input[name="T√™n ng∆∞·ªùi ƒë·∫∑t"]').focus();
}
</script>
{% endblock %} 